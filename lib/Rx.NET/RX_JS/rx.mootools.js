// Copyright (c) Microsoft Corporation.  All rights reserved.
// This code is licensed by Microsoft Corporation under the terms
// of the MICROSOFT REACTIVE EXTENSIONS FOR JAVASCRIPT AND .NET LIBRARIES License.
// See http://go.microsoft.com/fwlink/?LinkId=186234.

(function(){var a;if(typeof ProvideCustomRxRootObject =="undefined")a=this.Rx; else a=ProvideCustomRxRootObject();var b=a.Observable;var c=b.FromMooToolsEvent=function(f,g){return b.Create(function(h){var i=function(j){h.OnNext(j);};f.addEvent(g,i);return function(){f.removeEvent(g,i);};});};var d=function(f){return c(this,f);};Window.implement({addEventAsObservable:d});Document.implement({addEventAsObservable:d});Element.implement({addEventAsObservable:d});Elements.implement({addEventAsObservable:d});Events.implement({addEventAsObservable:d});var e=b.MooToolsRequest=function(f){var g=new a.AsyncSubject();var h=null;try{newOptions.onSuccess=function(j,k){g.OnNext({responseText:j,responseXML:k});g.OnCompleted();};newOptions.onFailure=function(j){g.OnError({kind:"failure",xhr:j});};newOptions.onException=function(j,k){g.OnError({kind:"exception",headerName:j,value:k});};h=new Request(newOptions);h.send();}catch(j){g.OnError(j);}var i=new a.RefCountDisposable(a.Disposable.Create(function(){if(h)h.cancel();}));return b.CreateWithDisposable(function(j){return new a.CompositeDisposable(g.Subscribe(j),i.GetDisposable());});};Request.implement({toObservable:function(){var f=new a.AsyncSubject();var g=this;try{g.addEvents({success:function(i,j){f.OnNext({responseXML:j,responseText:i});f.OnCompleted();},failure:function(i){f.OnError({kind:"failure",xhr:i});},exception:function(i,j){f.OnError({kind:"exception",headerName:i,value:j});}});g.send();}catch(i){f.OnError(i);}var h=new a.RefCountDisposable(a.Disposable.Create(function(){g.cancel();}));return b.CreateWithDisposable(function(i){return new a.CompositeDisposable(f.Subscribe(i),h.GetDisposable());});}});b.MooToolsJSONRequest=function(f){var g=new a.AsyncSubject();var h=null;try{newOptions.onSuccess=function(j,k){g.OnNext({responseJSON:j,responseText:k});g.OnCompleted();};newOptions.onFailure=function(j){g.OnError({kind:"failure",xhr:j});};newOptions.onException=function(j,k){g.OnError({kind:"exception",headerName:j,value:k});};h=new Request(newOptions);h.send();}catch(j){g.OnError(j);}var i=new a.RefCountDisposable(a.Disposable.Create(function(){if(h)h.cancel();}));return b.CreateWithDisposable(function(j){return new a.CompositeDisposable(g.Subscribe(j),i.GetDisposable());});};Request.JSON.implement({toObservable:function(){var f=new a.AsyncSubject();var g=this;try{g.addEvents({success:function(i,j){f.OnNext({responseJSON:i,responseText:j});f.OnCompleted();},failure:function(i){f.OnError({kind:"failure",xhr:i});},exception:function(i,j){f.OnError({kind:"exception",headerName:i,value:j});}});g.send();}catch(i){f.OnError(i);}var h=new a.RefCountDisposable(a.Disposable.Create(function(){g.cancel();}));return b.CreateWithDisposable(function(i){return new a.CompositeDisposable(f.Subscribe(i),h.GetDisposable());});}});b.MooToolsHTMLRequest=function(f){var g={};for(var h in f) g[h]=f[h];var i=new a.AsyncSubject();var j=null;try{g.onSuccess=function(l){i.OnNext(l);i.OnCompleted();};g.onFailure=function(l){i.OnError({kind:"failure",xhr:l});};g.onException=function(l,m){i.OnError({kind:"exception",headerName:l,value:m});};j=new Request.HTML(g);j.send();}catch(l){i.OnError(l);}var k=new a.RefCountDisposable(a.Disposable.Create(function(){if(j)j.cancel();}));return b.CreateWithDisposable(function(l){return new a.CompositeDisposable(i.Subscribe(l),k.GetDisposable());});};Request.HTML.implement({toObservable:function(){var f=new a.AsyncSubject();var g=this;try{g.addEvents({success:function(i){f.OnNext(i);f.OnCompleted();},failure:function(i){f.OnError({kind:"failure",xhr:i});},exception:function(i,j){f.OnError({kind:"exception",headerName:i,value:j});}});g.send();}catch(i){f.OnError(i);}var h=new a.RefCountDisposable(a.Disposable.Create(function(){g.cancel();}));return b.CreateWithDisposable(function(i){return new a.CompositeDisposable(f.Subscribe(i),h.GetDisposable());});}});b.MooToolsJSONPRequest=function(f){var g=new a.AsyncSubject();var h=null;try{f.onSuccess=function(j){g.OnNext(j);g.OnCompleted();};f.onFailure=function(j){g.OnError({kind:"failure",xhr:j});};f.onException=function(j,k){g.OnError({kind:"exception",headerName:j,value:k});};h=new Request.JSONP(f);h.send();}catch(j){g.OnError(j);}var i=new a.RefCountDisposable(a.Disposable.Create(function(){if(h)h.cancel();}));return b.CreateWithDisposable(function(j){return new a.CompositeDisposable(g.Subscribe(j),i.GetDisposable());});};Request.JSONP.implement({toObservable:function(){var f=new a.AsyncSubject();var g=this;try{g.addEvents({success:function(i){f.OnNext(i);f.OnCompleted();},failure:function(i){f.OnError({kind:"failure",xhr:i});},exception:function(i,j){f.OnError({kind:"exception",headerName:i,value:j});}});g.send();}catch(i){f.OnError(i);}var h=new a.RefCountDisposable(a.Disposable.Create(function(){g.cancel();}));return b.CreateWithDisposable(function(i){return new a.CompositeDisposable(f.Subscribe(i),h.GetDisposable());});}});})();