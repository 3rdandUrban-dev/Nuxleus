(function(a){var b=a.App;b.Twitter=b.BaseModel.extend({defaults:{screenName:null,tab:"timelines",timelines:[],tweets:[],friends:[],followers:[],profile_image_url:null,screen_name:null,description:null,statuses_count:null,friends_count:null,followers_count:null},initialize:function(){_.bindAll(this,"twitterProfileChange","twitterTab","screenNameChanged","tabChanged"),this.on("change:screenName",this.screenNameChanged),this.on("change:tab",this.tabChanged)},isLoaded:function(){return!!this.get("screenName")},error:function(a){$("#twitter .tab-content").html('<div class="alert alert-error">'+(a.message||a)+"</div>")},screenNameChanged:function(){$("BODY").toggleClass("self",this.viewingSelf());if(!this.get("screenName"))return;var a=this,b="api/twitter/"+this.get("screenName");_.get(b,function(b){var c={};_.extend(c,b.results[0]),a.set(c),a.load(a.tab())},this.error)},tabChanged:function(){$(".tabs ."+this.tab()+" a").tab("show"),this.load(this.tab())},load:function(a){a=a||this.defaults.tab;var b=this,c={},d=a==="directmessages"?a:this.get("screenName")+"/"+a;c[a]=[],b.set(c),_.get("api/twitter/"+d,function(d){c[a]=d.results,b.set(c)},this.error)},twitterProfileChange:function(a,c){this.set({screenName:a||b.twitterScreenName(),tab:c||this.tab()},{silent:!b.isAuth()}),this.navigate(this.navUrl())},viewingSelf:function(){return b.twitterScreenName()===this.get("screenName")},navUrl:function(){return(this.viewingSelf()?"":this.get("screenName")+"/")+this.get("tab")},tab:function(){return this.get("tab")||this.defaults.tab},twitterTab:function(a){a=a||this.tab(),this.set({tab:a}),this.navigate(this.navUrl())}}),b.TwitterView=b.BaseView.extend({initialize:function(){_.bindAll(this,"render"),this.$el=$(this.el),this.$signedInBody=this.$el.find(".signed-in .tab-content"),this.tweetsTemplate=_.template($("#template-tweets").html()),this.usersTemplate=_.template($("#template-users").html()),this.directMessagesTemplate=_.template($("#template-directmessages").html()),this.currentUserTemplate=_.template($("#template-current-user").html());var a=_.map(_.keys(this.tabHooks),function(a){return"change:"+a}).join(" ");this.model.on(a,this.render)},tabHooks:{friends:function(){return this.usersTemplate({users:this.model.get("friends")})},followers:function(){return this.usersTemplate({users:this.model.get("followers")})},timelines:function(){return this.tweetsTemplate({tweets:this.model.get("timelines")})},tweets:function(){return this.tweetsTemplate({tweets:this.model.get("tweets")})},directmessages:function(){return this.directMessagesTemplate({tweets:this.model.get("directmessages")})}},render:function(){var a=this.model.get("screenName"),b="";if(a){var c=this.model.tab();b=this.tabHooks[c].call(this),this.$(".current-user").html(this.currentUserTemplate(this.model.toJSON()));var d=this.model.get("profile_background_image_url"),e=this.model.get("profile_background_color")||"",f=this.model.get("profile_background_tile")==="true"?"":"no-repeat",g=d?"#"+e+" url("+d+") "+f+" top left":"";$("BODY").css({background:g,"background-attachment":"fixed"})}this.$signedInBody.html(b)}})})(window)