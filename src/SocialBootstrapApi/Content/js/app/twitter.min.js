(function(a){var b=a.App;b.Twitter=b.BaseModel.extend({defaults:{screenName:null,tab:"timelines",timelines:[],tweets:[],friends:[],followers:[],profile_image_url:null,screen_name:null,description:null,statuses_count:null,friends_count:null,followers_count:null},initialize:function(a){_.bindAll(this,"twitterProfileChange","twitterTab","screenNameChanged","tabChanged"),this.on("change:screenName",this.screenNameChanged),this.on("change:tab",this.tabChanged)},isLoaded:function(){return!!this.get("screenName")},screenNameChanged:function(){console.log("changeScreenName: "+this.get("screenName")),$("BODY").toggleClass("self",this.viewingSelf());var a=this.get("screenName");if(!a)return;var b=this,c="api/twitter/"+a;_.get(c,function(a){var c={};_.extend(c,a.results[0]),b.set(c),b.load(b.tab())})},tabChanged:function(){console.log("changeTab: "+this.tab()),$(".tabs [href=#"+this.tab()+"]").click(),this.load(this.tab())},load:function(a){console.log("load: "+a),a=a||this.defaults.tab;var b=this,c={},d=a==="directmessages"?a:this.get("screenName")+"/"+a;c[a]=[],b.set(c),_.get("api/twitter/"+d,function(d){c[a]=d.results,b.set(c)})},twitterProfileChange:function(a,c){console.log("twitter.twitterProfileChange: "+a+"/"+c),this.set({screenName:a||b.twitterScreenName(),tab:c||this.tab()},{silent:!b.isAuth()}),this.navigate(this.navUrl())},viewingSelf:function(){return b.twitterScreenName()===this.get("screenName")},navUrl:function(){return(this.viewingSelf()?"":this.get("screenName")+"/")+this.get("tab")},tab:function(){return this.get("tab")||this.defaults.tab},twitterTab:function(a){a=a||this.tab(),console.log("twitterTab:"+a),this.set({tab:a}),this.navigate(this.navUrl())}}),b.TwitterView=b.BaseView.extend({initialize:function(){_.bindAll(this,"render"),this.$el=$(this.el),this.$signedInBody=this.$el.find(".signed-in .tab-content"),this.tweetsTemplate=_.template($("#template-tweets").html()),this.usersTemplate=_.template($("#template-users").html()),this.directMessagesTemplate=_.template($("#template-directmessages").html()),this.currentUserTemplate=_.template($("#template-current-user").html());var a=_.map(_.keys(this.tabHooks),function(a){return"change:"+a}).join(" ");this.model.on(a,this.render)},tabHooks:{friends:function(){return this.usersTemplate({users:this.model.get("friends")})},followers:function(){return this.usersTemplate({users:this.model.get("followers")})},timelines:function(){return this.tweetsTemplate({tweets:this.model.get("timelines")})},tweets:function(){return this.tweetsTemplate({tweets:this.model.get("tweets")})},directmessages:function(){return this.directMessagesTemplate({tweets:this.model.get("directmessages")})}},render:function(){console.log("twitter.render: ");var a=this.model.get("screenName"),b="";if(a){var c=this.model.tab();b=this.tabHooks[c].call(this),this.$(".current-user").html(this.currentUserTemplate(this.model.toJSON()));var d=this.model.get("profile_background_image_url"),e=this.model.get("profile_background_color")||"",f=this.model.get("profile_background_tile")==="true"?"":"no-repeat",g=d?"#"+e+" url("+d+") "+f+" top left":"";$("BODY").css({background:g,"background-attachment":"fixed"})}this.$signedInBody.html(b)}})})(window)