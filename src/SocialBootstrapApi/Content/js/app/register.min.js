(function(a){var b=a.App;b.RegisterView=b.BaseView.extend({className:"view-register",initialize:function(){_.bindAll(this,"render","register","registerSuccess","login"),this.model.bind("change",this.render),this.$("[name=displayName]").val(localStorage.getItem("displayName")),this.$("[name=email]").val(localStorage.getItem("email")),this.$el=$(this.el),this.$errorMsg=this.$el.find("form b[data-error=summary]"),this.$signup=$(this.el).find("#signup"),this.$registerLogin=$(this.el).find("#register-login"),this.$signup.find("form").submit(this.register),this.$registerLogin.find("form").submit(this.login)},register:function(a){a&&a.preventDefault();var b=this.$signup.find("form");_.post({form:b,url:b.attr("action"),data:_.formData(b),success:this.registerSuccess}),this.$registerLogin.find("INPUT[name=userName]").val(b.find("INPUT[name=email]").val()),localStorage.setItem("displayName",this.$("[name=displayName]").val()),localStorage.setItem("email",this.$("[name=email]").val())},registerSuccess:function(a){this.model.set({hasRegistered:!0,userId:a.userId,isAuthenticated:!!a.sessionId})},login:function(a){a&&a.preventDefault(),this.model.login(this.$registerLogin.find("form"))},signIn:function(a){this.model.set({hasRegistered:!0})},unregistered:function(a){this.model.set({hasRegistered:!1})},render:function(){this.$errorMsg.html(""),$("BODY").toggleClass("registered",this.model.get("hasRegistered"))}})})(window)